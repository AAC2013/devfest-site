{% set subtype = "sponsor" %}
{% extends "event_base.html" %}

{% block head2 %}
<script type="text/javascript">
$(document).ready(function() {
  $('#add_sponsor').click(function() {
    clone_field_list('#sponsors li:last');
  });
  handle_delete_buttons('#sponsors');
});

function handle_delete_buttons(selector) {
  if ($(selector).children('li').length < 2) {
    // remove delete button
    $(selector).children('li').each(function() {
      $(this).children('label')[0].innerHTML = "";
    });
  }
  else {
    // add delete buttons
    $(selector).children('li').each(function() {
      var label = $(this).children('label')[0];
      var id = $(this).children('table').attr('id');
      label.innerHTML = "<input type='button' onclick='del_sponsor(\"" +
            id + "\");' value='delete' />";
    });
  }
}

function del_sponsor(id) {
  $('#' + id).parent().remove();
  handle_delete_buttons('#sponsors');
}

function clone_field_list(selector) {
  var new_element = $(selector).clone(true);
  var elem_id = new_element.find('input')[0].id;
  var elem_num = parseInt(elem_id.replace(/.*-(\d{1,4})-.*/m, '$1')) + 1;
  new_element.find(':input').each(function() {
    var id = $(this).attr('id').replace('-' + (elem_num - 1) + '-', '-' + elem_num + '-');
    $(this).attr({'name': id, 'id': id}).val('').removeAttr('checked');
  });
  new_element.find('label').each(function() {
    var new_for = $(this).attr('for').replace('-' + (elem_num - 1) + '-', '-' + elem_num + '-');
    $(this).attr('for', new_for);
  });
  new_element.children('label')[0].innerHTML = "New Speaker";
  $(selector).after(new_element);
  handle_delete_buttons('#sponsors');
}
</script>
{% endblock %}

{% block formfields %}
{{ with_errors(form.sponsors) }}
<input type="button" id="add_sponsor" value="add sponsor">
{% endblock %}
